{"name": "车型信息", "status": "failed", "statusDetails": {"message": "AssertionError: 错误信息：Traceback (most recent call last):\n  File \"D:\\Pytest_API\\comm\\check_result.py\", line 53, in test_check_result\n    assert str(expected_code) == str(actual_code)\nAssertionError", "trace": "self = <comm.check_result.Check_Result object at 0x000001B389B34100>\nvalidate = {'check_mode': 'check_code', 'expected_code': 401, 'expected_desc': {'$..msg': '门店车型代码重复！'}, 'expected_format': {'code': 101058, 'data': {}, 'msg': '门店车型代码重复！', 'success': False}}\nresponse = [400, '{\"error\":\"invalid_grant\",\"error_description\":\"Bad credentials\"}']\n\n    def test_check_result(self,validate,response):\n        \"\"\"\n        校验预期结果与实际结果是否一致\n        \"\"\"\n    \n        if response ==None:\n            with allure.step(\"验证信息\"):\n                allure.attach(name=\"待核验信息\", body=str(validate))\n                allure.attach(name=\"检查模式\", body=str(validate['check_mode']))\n                allure.attach(name=\"预期响应码\", body=str(validate['expected_code']))\n                allure.attach(name=\"待核验字段信息\", body=str(validate['expected_desc']))\n                allure.attach(name=\"预期数据--数据格式\", body=str(validate['expected_format']))\n                allure.attach(name=\"实际数据\", body=str(response))\n                allure.attach(name=\"验证结果\", body=str('通过' if validate == response else '失败'))\n    \n    \n            assert validate == response\n            log.info('\\n待核验信息：{0} \\n实际数据：{1} \\n校验结果：'.format(validate,  response,('通过' if validate == response else '失败')))\n    \n    \n        else:\n            response = json.loads(response)\n    \n            if validate['check_mode'] == 'no_check':\n                with allure.step(\"验证信息--不校验接口结果\"):\n                    pass\n    \n    \n            elif validate['check_mode'] == 'check_code':\n                expected_code = validate['expected_code']\n                actual_code = response[0]\n    \n                with allure.step(\"验证信息--校验响应码\"):\n                    allure.attach(name=\"待核验信息\", body=str(validate))\n                    allure.attach(name=\"检查模式\", body=str(validate['check_mode']))\n                    allure.attach(name=\"预期响应码\", body=str(validate['expected_code']))\n                    allure.attach(name=\"实际响应码\", body=str(response[0]))\n                try:\n>                   assert str(expected_code) == str(actual_code)\nE                   AssertionError\n\ncomm\\check_result.py:53: AssertionError\n\nDuring handling of the above exception, another exception occurred:\n\nself = <comm.testcase_parameter.Testcase_Suite object at 0x000001B389B34E80>\ncase = {'api_name': '车型信息', 'case_id': 4, 'case_name': '新增车型信息', 'cookies': False, ...}\n\n    @pytest.mark.parametrize('case', cases)\n    def testcase_parameter(self,case):\n        try:\n            case_id = case['case_id']\n            api_name = case['api_name']\n            case_name = case['case_name']\n            level = case['level']\n            premise_caseid = case['premise_caseid']\n            premise_key = case['premise_key']\n            relevance_field = case['relevance_field']\n            api_url = case['url']\n            method = case['method']\n            data = case['data']\n            headers = case['headers']\n            mime_type = case['mime_type']\n            files = case['files']\n            cookies = case['cookies']\n            timeout = case['timeout']\n            validate = case['validate']\n            host = p.get_url_parameter()\n            url = host + api_url\n    \n    \n    \n    \n        except Exception as e:\n            log.error(traceback.format_exc())\n            raise KeyError('获取用例基本信息失败：{}'.format(e))\n    \n        log.info(\"*\" * 200)\n        log.info(\"用例id：%s\" % str(case_id))\n        log.info(\"接口名称：%s\" % str(api_name))\n        log.info(\"用例名称：%s\" % str(case_name))\n        log.info(\"前置用例：%s\" % str(premise_caseid))\n        log.info(\"前置用例响应数据：%s\" % str(premise_key))\n        log.info(\"数据依赖字段：%s\" % str(relevance_field))\n        log.info(\"api_url：%s\" % str(api_url))\n        log.info(\"请求地址：%s\" % str(url))\n        log.info(\"请求方式：%s\" % str(method))\n        log.info(\"请求数据：%s\" % str(data))\n        log.info(\"请求头信息：%s\" % str(headers))\n        log.info(\"参数媒体类型：%s\" % str(mime_type))\n        log.info(\"上传文件：%s\" % str(files))\n        log.info(\"cookies：%s\" % str(cookies))\n        log.info(\"超时时长：%s\" % str(timeout))\n        log.info(\"待核验信息：%s\" % str(validate))\n    \n    \n    \n        if premise_caseid:\n            with allure.step(\"前置条件：\"):\n                allure.attach(name=\"前置条件--依赖caseid\", body=str(premise_caseid))\n                allure.attach(name=\"前置条件--依赖字段key\", body=str(premise_key))\n                allure.attach(name=\"前置条件--关联字段key\", body=str(relevance_field))\n                allure.dynamic.description(case_name)\n                allure.dynamic.severity(level)\n                allure.dynamic.title(api_name)\n                allure.dynamic.description(case_name)\n                allure.dynamic.link(name='百度首页地址', url='https://www.baidu.com/')\n    \n            response = de.get_dependent_case(case_id)\n    \n            with allure.step(\"请求数据信息：\"):\n                allure.attach(name=\"请求地址\", body=url)\n                allure.attach(name=\"请求头信息\", body=str(headers))\n                allure.attach(name=\"请求数据\", body=str(data))\n                allure.attach(name=\"上传文件信息\", body=str(files))\n                allure.attach(name=\"请求数据响应信息\", body=str( response if response==None else json.loads(response)))\n    \n    \n            log.info('用例参数化--附带前置用例,请求响应信息:{0}'.format(response if response==None else json.loads(response)))\n    \n>           cr.test_check_result(validate,response)\n\ncomm\\testcase_parameter.py:106: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _\n\nself = <comm.check_result.Check_Result object at 0x000001B389B34100>\nvalidate = {'check_mode': 'check_code', 'expected_code': 401, 'expected_desc': {'$..msg': '门店车型代码重复！'}, 'expected_format': {'code': 101058, 'data': {}, 'msg': '门店车型代码重复！', 'success': False}}\nresponse = [400, '{\"error\":\"invalid_grant\",\"error_description\":\"Bad credentials\"}']\n\n    def test_check_result(self,validate,response):\n        \"\"\"\n        校验预期结果与实际结果是否一致\n        \"\"\"\n    \n        if response ==None:\n            with allure.step(\"验证信息\"):\n                allure.attach(name=\"待核验信息\", body=str(validate))\n                allure.attach(name=\"检查模式\", body=str(validate['check_mode']))\n                allure.attach(name=\"预期响应码\", body=str(validate['expected_code']))\n                allure.attach(name=\"待核验字段信息\", body=str(validate['expected_desc']))\n                allure.attach(name=\"预期数据--数据格式\", body=str(validate['expected_format']))\n                allure.attach(name=\"实际数据\", body=str(response))\n                allure.attach(name=\"验证结果\", body=str('通过' if validate == response else '失败'))\n    \n    \n            assert validate == response\n            log.info('\\n待核验信息：{0} \\n实际数据：{1} \\n校验结果：'.format(validate,  response,('通过' if validate == response else '失败')))\n    \n    \n        else:\n            response = json.loads(response)\n    \n            if validate['check_mode'] == 'no_check':\n                with allure.step(\"验证信息--不校验接口结果\"):\n                    pass\n    \n    \n            elif validate['check_mode'] == 'check_code':\n                expected_code = validate['expected_code']\n                actual_code = response[0]\n    \n                with allure.step(\"验证信息--校验响应码\"):\n                    allure.attach(name=\"待核验信息\", body=str(validate))\n                    allure.attach(name=\"检查模式\", body=str(validate['check_mode']))\n                    allure.attach(name=\"预期响应码\", body=str(validate['expected_code']))\n                    allure.attach(name=\"实际响应码\", body=str(response[0]))\n                try:\n                    assert str(expected_code) == str(actual_code)\n                except AssertionError as e:\n                    log.error('\\n预期响应码:{0} \\n实际响应码:{1} \\n错误信息:{2}'.format(expected_code, actual_code,\n                                                                                        traceback.format_exc()))\n>                   raise AssertionError('错误信息：{}'.format(traceback.format_exc()))\nE                   AssertionError: 错误信息：Traceback (most recent call last):\nE                     File \"D:\\Pytest_API\\comm\\check_result.py\", line 53, in test_check_result\nE                       assert str(expected_code) == str(actual_code)\nE                   AssertionError\n\ncomm\\check_result.py:57: AssertionError"}, "description": "新增车型信息", "steps": [{"name": "前置条件：", "status": "passed", "attachments": [{"name": "前置条件--依赖caseid", "source": "62a806fb-034d-4322-b7a3-149902307063-attachment.attach"}, {"name": "前置条件--依赖字段key", "source": "a1d67afc-db84-4392-9990-9b9f879fa9aa-attachment.attach"}, {"name": "前置条件--关联字段key", "source": "81f01ffd-91cd-4ead-a442-a0d0f7eb7466-attachment.attach"}], "start": 1692546683770, "stop": 1692546683772}, {"name": "请求数据信息：", "status": "passed", "attachments": [{"name": "请求地址", "source": "7b3fa9b6-6592-4494-8915-c492ebcf7214-attachment.attach"}, {"name": "请求头信息", "source": "ed777a7f-4420-47f1-af60-86ea19dea466-attachment.attach"}, {"name": "请求数据", "source": "53ff8786-c1ca-4509-8e14-ef1aaacb0eaa-attachment.attach"}, {"name": "上传文件信息", "source": "2ecb3e01-4259-4ad0-8945-39b6076b2883-attachment.attach"}, {"name": "请求数据响应信息", "source": "1ad9c4c8-b3ef-4180-8ad8-2a7bb7af7f24-attachment.attach"}], "start": 1692546685047, "stop": 1692546685051}, {"name": "验证信息--校验响应码", "status": "passed", "attachments": [{"name": "待核验信息", "source": "dafe7a04-672b-4df2-ae8f-4abfb605c757-attachment.attach"}, {"name": "检查模式", "source": "5dd96fc2-185d-44b5-9e3d-a7ef33f37309-attachment.attach"}, {"name": "预期响应码", "source": "088aaeb8-e594-448e-b657-375af42ebdff-attachment.attach"}, {"name": "实际响应码", "source": "a8e6ed20-0383-443b-be84-2a1fc05c7992-attachment.attach"}], "start": 1692546685052, "stop": 1692546685055}], "attachments": [{"name": "log", "source": "2a2a9dee-a2fc-4775-afc0-90d0172a2c07-attachment.txt", "type": "text/plain"}], "parameters": [{"name": "case", "value": "{'case_id': 4, 'api_name': '车型信息', 'case_name': '新增车型信息', 'is_run': True, 'level': 'trivial', 'premise_caseid': 1, 'premise_key': 'detail.type', 'relevance_field': 'deptSeriesId', 'url': 'api/ld-erps/deptcartype/submit', 'method': 'post', 'data': {'brandName': '1500010931297513473', 'deptBrandId': '1500010931297513473', 'deptFirmId': '1500010984066052098', 'deptSeriesId': '1500011053616001025', 'typeName': 'a1', 'typeCode': 'a23', 'ageStyleType': 1, 'ageStyleTypeName': '1', 'gearBoxType': 1, 'gearBoxTypeName': '1', 'engineCapacity': 'a4', 'emissionStandard': 1, 'emissionStandardName': '1', 'versionNo': 'a5', 'powerType': 1, 'powerTypeName': '1', 'guidePrice': '6', 'costPrice': '7', 'referenceRebate': '7', 'status': 1, 'furl': '', 'imgsUrl': 'upload/20230718/b817487e07842052d575d9d2935a29fd.jpg', 'remark': '<p>豪车</p>', 'appliedScope': '1,2'}, 'headers': {'Content-Type': 'application/json;charset=UTF-8', 'Authorization': 'Basic c2FiZXI6bGRAMTIzNDU2', 'Blade-Auth': 'bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ0ZW5hbnRfaWQiOiI2ODMyNTIiLCJ0ZW5hbnRfbmFtZSI6Iua8lOekuuenn-aItyjmlbDmja7lvILluLjmmoLlgZzkvb_nlKgpIiwidXNlcl9uYW1lIjoiYWRtaW4iLCJkZXB0X25hbWUiOiLmvJTnpLrnp5_miLciLCJyZWFsX25hbWUiOiJhZG1pbiIsImF2YXRhciI6InVwbG9hZC8yMDIyMDExMi8zZTg3ZDI2YzZhMzUxOWM5YmM5N2YwM2I2Y2E0N2E3OS5wbmciLCJhdXRob3JpdGllcyI6WyJhZG1pbiJdLCJjbGllbnRfaWQiOiJzYWJlciIsInJvbGVfbmFtZSI6ImFkbWluIiwicG9zdF9pZCI6IjE0ODEyMDc0NTI2NzU5NDQ0NDkiLCJ1c2VyX2lkIjoiMTQ3MzQ4MjMxOTgxNzk2OTY2NSIsInJvbGVfaWQiOiIxNDczNDgyMzEwNTQwNjU2NjQxIiwicG9zdF9uYW1lIjoiY2VvIiwic2NvcGUiOlsiYWxsIl0sIm5pY2tfbmFtZSI6ImFkbWluIiwib2F1dGhfaWQiOiIiLCJkZXRhaWwiOnsidHlwZSI6IndlYiJ9LCJleHAiOjE2ODk2ODAxMzEsImRlcHRfaWQiOiIxNDczNDgyMzE0MzcwMDU2MTk0IiwicG93ZXJlZCBieSBsZCI6InBvd2VyZWQgYnkgYmxhZGV4IiwianRpIjoiNjY4NDAwOGEtYWUwMi00YzQ0LWE2OWItY2FiYzdkZjY3ZWUzIiwiYWNjb3VudCI6ImFkbWluIn0.u01NTOYLZSSCyoUsKowvKEWyTW_1qDeBXqdszhQkbxw', 'Cookie': 'saber-refresh-token=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ0ZW5hbnRfaWQiOiI2ODMyNTIiLCJ0ZW5hbnRfbmFtZSI6Iua8lOekuuenn-aItyjmlbDmja7lvILluLjmmoLlgZzkvb_nlKgpIiwidXNlcl9uYW1lIjoiYWRtaW4iLCJkZXB0X25hbWUiOiLmvJTnpLrnp5_miLciLCJyZWFsX25hbWUiOiJhZG1pbiIsImF2YXRhciI6InVwbG9hZC8yMDIyMDExMi8zZTg3ZDI2YzZhMzUxOWM5YmM5N2YwM2I2Y2E0N2E3OS5wbmciLCJhdXRob3JpdGllcyI6WyJhZG1pbiJdLCJjbGllbnRfaWQiOiJzYWJlciIsInJvbGVfbmFtZSI6ImFkbWluIiwicG9zdF9pZCI6IjE0ODEyMDc0NTI2NzU5NDQ0NDkiLCJ1c2VyX2lkIjoiMTQ3MzQ4MjMxOTgxNzk2OTY2NSIsInJvbGVfaWQiOiIxNDczNDgyMzEwNTQwNjU2NjQxIiwicG9zdF9uYW1lIjoiY2VvIiwic2NvcGUiOlsiYWxsIl0sIm5pY2tfbmFtZSI6ImFkbWluIiwiYXRpIjoiNjY4NDAwOGEtYWUwMi00YzQ0LWE2OWItY2FiYzdkZjY3ZWUzIiwib2F1dGhfaWQiOiIiLCJkZXRhaWwiOnsidHlwZSI6IndlYiJ9LCJleHAiOjE2OTAyODEzMzEsImRlcHRfaWQiOiIxNDczNDgyMzE0MzcwMDU2MTk0IiwicG93ZXJlZCBieSBsZCI6InBvd2VyZWQgYnkgYmxhZGV4IiwianRpIjoiZTg1NDE0NGQtZTY5Zi00MGY3LWJjM2MtNTZjOTU1ZjEzNDFiIiwiYWNjb3VudCI6ImFkbWluIn0.J8qEnQvTnFrl-WQrJRmIuOq468SeHwenrHrph6J-U20', 'dept_id': '1473482314370056194', 'Tenant-Id': '683252'}, 'mime_type': 'application/json', 'files': None, 'cookies': False, 'timeout': 10, 'validate': {'check_mode': 'check_code', 'expected_code': 401, 'expected_desc': {'$..msg': '门店车型代码重复！'}, 'expected_format': {'code': 101058, 'success': False, 'data': {}, 'msg': '门店车型代码重复！'}}}"}], "start": 1692546683767, "stop": 1692546685055, "uuid": "83f8f1c7-46c9-4697-8b5f-58e14583e299", "historyId": "0dcc9231409c3caa377dcfa586d78a5c", "testCaseId": "50de78f06f8e376387dec188168c33d6", "fullName": "comm.testcase_parameter.Testcase_Suite#testcase_parameter", "labels": [{"name": "severity", "value": "trivial"}, {"name": "epic", "value": "测试用例汇总"}, {"name": "story", "value": "参数化--测试用例"}, {"name": "feature", "value": "测试用例集合"}, {"name": "parentSuite", "value": "comm"}, {"name": "suite", "value": "testcase_parameter"}, {"name": "subSuite", "value": "Testcase_Suite"}, {"name": "host", "value": "LAPTOP-T1AV2QHS"}, {"name": "thread", "value": "17020-MainThread"}, {"name": "framework", "value": "pytest"}, {"name": "language", "value": "cpython3"}, {"name": "package", "value": "comm.testcase_parameter"}], "links": [{"type": "link", "url": "https://www.baidu.com/", "name": "百度首页地址"}]}